/*
Triangle, pentagonal, and hexagonal numbers are generated by the following formulae:
Triangle    Tn=n(n+1)/2        1, 3, 6, 10, 15, ...
Pentagonal  Pn=n(3n - 1)/2     1, 5, 12, 22, 35, ...
Hexagonal   Hn=n(2n - 1)       1, 6, 15, 28, 45, ...
It can be verified that T285 = P165 = H143 = 40755.
Find the next triangle number that is also pentagonal and hexagonal.
*/

/*
We can see that Hi > Pi > Ti. So testing all Hi will find the solution faster.

For a number to be triangular, 8n + 1 must be square.
For a number to be pentagonal, 24n + 1 must be square AND 1 + sqrt(24n + 1) must be divisible by 6.
For a number to be hexagonal, 8n + 1 must be square AND 1 + sqrt(8n + 1) must be divisible by 4.

So it is actually easier to check for triangular and hexagonal.
*/

#include <stdlib.h>
#include <stdio.h>
#include <stdbool.h>
#include <string.h>

#define ULL unsigned long long

ULL isSquare(ULL n) {
    ULL t = n >> 1;
    while (t * t > n) t >>= 1;
    for (t; t * t <= n; t++) if (t * t == n) return t;
    return -1;
}

int main() {
    ULL p = 40755ULL, r;
    for (int i = 166; i < 100000; i++) {
        p += 3 * i - 2;
        r = isSquare(8 * p + 1);
        if (r != -1 && ((1 + r) % 4 == 0)) {
            printf("%lld\n", p);
            break;
        }
    }
    return 0;
}